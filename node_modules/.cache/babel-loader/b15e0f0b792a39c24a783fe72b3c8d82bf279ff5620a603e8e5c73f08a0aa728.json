{"ast":null,"code":"import _regeneratorRuntime from\"/Users/nobuoezaki/Desktop/ezaki-lab/2023moba/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/nobuoezaki/Desktop/ezaki-lab/2023moba/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/nobuoezaki/Desktop/ezaki-lab/2023moba/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from'react';import{Map}from'./Map';import{Calender}from'./Calender';import axios from'axios';import'./css/App.css';import{TimeList}from'./TimeList';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var App=function App(){// DOMに現れるものをuseState，表れないものをuseRefにする（レンダリングするかしないか）\nvar _useState=useState([]),_useState2=_slicedToArray(_useState,2),Positions=_useState2[0],setPositions=_useState2[1];//緯度経度\nvar _useState3=useState({lat:34.48520833,lng:136.8251525}),_useState4=_slicedToArray(_useState3,2),centerPositions=_useState4[0],setCenterPositions=_useState4[1];//中心座標\nvar _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),TimeDates=_useState6[0],setTimeDates=_useState6[1];//開始時間時間\nvar _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),selectedTime=_useState8[0],setSelectedTime=_useState8[1];//選択した時間\nvar tempTimeDates=[];// APIからデータ取得\nvar AccessApi=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(URL){var response;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return axios.get(URL);case 3:response=_context.sent;return _context.abrupt(\"return\",response.data);case 7:_context.prev=7;_context.t0=_context[\"catch\"](0);console.log(URL);_context.t1=_context.t0.response.status;_context.next=_context.t1===400?13:_context.t1===401?15:_context.t1===404?17:19;break;case 13:console.log('認証エラーです');return _context.abrupt(\"break\",20);case 15:console.log('認証エラーです');return _context.abrupt(\"break\",20);case 17:console.log('URL先がないです');return _context.abrupt(\"break\",20);case 19:console.log(_context.t0);case 20:throw _context.t0;case 21:case\"end\":return _context.stop();}},_callee,null,[[0,7]]);}));return function AccessApi(_x){return _ref.apply(this,arguments);};}();// 指定日の開始時間を取得\nvar GetTimeList=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(selectedDate){var URL,res;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:// console.log(selectedDate);\nURL=\"http://ezaki-lab.littlestar.jp/nict/api/get_start_data.php?date=\".concat(selectedDate);_context2.next=3;return AccessApi(URL);case 3:res=_context2.sent;tempTimeDates=res;console.log(res);_context2.next=8;return setTimeDates(res);case 8:case\"end\":return _context2.stop();}},_callee2);}));return function GetTimeList(_x2){return _ref2.apply(this,arguments);};}();// 指定日の緯度経度を取得\nvar GetPositions=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(checkedTime){var temp,checkedTimeIndex,startDate,endDate,URL,res;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:temp=TimeDates.map(function(item){return item.datetime;});checkedTimeIndex=temp.indexOf(checkedTime);if(!(checkedTimeIndex!==-1)){_context3.next=13;break;}startDate=temp[checkedTimeIndex].replace(' ','_');if(checkedTimeIndex!==temp.length-1){endDate=temp[checkedTimeIndex+1].replace(' ','_');}else{endDate=temp[checkedTimeIndex].replace(' ','_');}URL=\"http://ezaki-lab.littlestar.jp/nict/api/get_gps.php?start_date=\".concat(startDate,\"&end_date=\").concat(endDate);// console.log(URL);\nif(!(URL!=='')){_context3.next=13;break;}_context3.next=9;return AccessApi(URL);case 9:res=_context3.sent;res.forEach(function(item){for(var key in item){item[key]=parseFloat(item[key]);}});setPositions(res);setCenterPositions(res[0]);case 13:case\"end\":return _context3.stop();}},_callee3);}));return function GetPositions(_x3){return _ref3.apply(this,arguments);};}();useEffect(function(){_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(){var d,today;return _regeneratorRuntime().wrap(function _callee4$(_context4){while(1)switch(_context4.prev=_context4.next){case 0:d=new Date();today=\"\".concat(d.getFullYear(),\"-\").concat(d.getMonth()+1,\"-\").concat(d.getDate());_context4.next=4;return GetTimeList(today);case 4:console.log(tempTimeDates);_context4.next=7;return setTimeDates(tempTimeDates);case 7:case\"end\":return _context4.stop();}},_callee4);}))();},[]);return/*#__PURE__*/_jsxs(\"div\",{className:\"App\",children:[/*#__PURE__*/_jsxs(\"div\",{id:\"date_div\",className:\"calendar_container\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"\\u65E5\\u4ED8\\u9078\\u629E\"}),/*#__PURE__*/_jsx(Calender,{GetTimeList:GetTimeList,AccessApi:AccessApi,setTimeDates:setTimeDates,setPositions:setPositions,setSelectedTime:setSelectedTime}),/*#__PURE__*/_jsx(TimeList,{TimeDates:TimeDates,GetPositions:GetPositions,selectedTime:selectedTime,setSelectedTime:setSelectedTime})]}),/*#__PURE__*/_jsx(Map,{Positions:Positions,centerPositions:centerPositions})]});};export default App;","map":{"version":3,"names":["React","useState","useEffect","Map","Calender","axios","TimeList","jsx","_jsx","jsxs","_jsxs","App","_useState","_useState2","_slicedToArray","Positions","setPositions","_useState3","lat","lng","_useState4","centerPositions","setCenterPositions","_useState5","_useState6","TimeDates","setTimeDates","_useState7","_useState8","selectedTime","setSelectedTime","tempTimeDates","AccessApi","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","URL","response","wrap","_callee$","_context","prev","next","get","sent","abrupt","data","t0","console","log","t1","status","stop","_x","apply","arguments","GetTimeList","_ref2","_callee2","selectedDate","res","_callee2$","_context2","concat","_x2","GetPositions","_ref3","_callee3","checkedTime","temp","checkedTimeIndex","startDate","endDate","_callee3$","_context3","map","item","datetime","indexOf","replace","length","forEach","key","parseFloat","_x3","_callee4","d","today","_callee4$","_context4","Date","getFullYear","getMonth","getDate","className","children","id"],"sources":["/Users/nobuoezaki/Desktop/ezaki-lab/2023moba/src/App.js"],"sourcesContent":["import React, {useState, useEffect} from 'react';\nimport {Map} from './Map';\nimport {Calender} from './Calender';\n\nimport axios from 'axios';\nimport './css/App.css';\nimport { TimeList } from './TimeList';\n\nconst App = () => {\n  // DOMに現れるものをuseState，表れないものをuseRefにする（レンダリングするかしないか）\n  const [Positions, setPositions] = useState([]); //緯度経度\n  const [centerPositions, setCenterPositions] = useState({ lat: 34.48520833, lng: 136.8251525}); //中心座標\n  const [TimeDates, setTimeDates] = useState([]); //開始時間時間\n  const [selectedTime, setSelectedTime] = useState(''); //選択した時間\n  let tempTimeDates = [];\n\n  // APIからデータ取得\n  const AccessApi = async (URL) => {\n    try {\n      const response = await axios.get(URL);\n      return response.data;\n    } catch (error) {\n      console.log(URL);\n      switch (error.response.status) {\n        case 400:\n          console.log('認証エラーです');\n          break;\n        case 401:\n          console.log('認証エラーです');\n          break;\n        case 404:\n          console.log('URL先がないです');\n          break;\n        default:\n          console.log(error);\n      }\n      throw error;\n    }\n  };\n\n  // 指定日の開始時間を取得\n  const GetTimeList = async (selectedDate) => {\n    // console.log(selectedDate);\n    const URL = `http://ezaki-lab.littlestar.jp/nict/api/get_start_data.php?date=${selectedDate}`;\n    const res = await AccessApi(URL);\n    tempTimeDates = res;\n    console.log(res);\n    await setTimeDates(res);\n  }\n\n  // 指定日の緯度経度を取得\n  const GetPositions = async (checkedTime) => {\n    const temp = TimeDates.map((item) => {\n      return item.datetime;\n    });\n    const checkedTimeIndex = temp.indexOf(checkedTime);\n    if(checkedTimeIndex !== -1) {\n      const startDate = temp[checkedTimeIndex].replace(' ', '_');\n      let endDate;\n      if(checkedTimeIndex !== temp.length - 1) {\n        endDate = temp[checkedTimeIndex + 1].replace(' ', '_');\n      }\n      else{\n        endDate = temp[checkedTimeIndex].replace(' ', '_');\n      }\n      const URL = `http://ezaki-lab.littlestar.jp/nict/api/get_gps.php?start_date=${startDate}&end_date=${endDate}`;\n      // console.log(URL);\n\n      if(URL !== ''){\n        const res = await AccessApi(URL);\n        res.forEach(function (item) {\n          for (var key in item) {\n            item[key] = parseFloat(item[key]);\n          }\n        });\n        setPositions(res);\n        setCenterPositions(res[0])\n      }\n    }\n  }\n\n  useEffect(() => {\n    (async() => {\n      const d = new Date();\n      const today = `${d.getFullYear()}-${d.getMonth()+1}-${d.getDate()}`\n      await GetTimeList(today);\n      console.log(tempTimeDates);\n      await setTimeDates(tempTimeDates);\n      // await setSelectedTime(tempTimeDates[0].datetime);\n      // await GetPositions(tempTimeDates);\n    })()\n  }, []);\n\n  return (\n    <div className=\"App\">\n      <div id=\"date_div\" className=\"calendar_container\">\n        <h1>日付選択</h1>\n        <Calender GetTimeList={GetTimeList} AccessApi={AccessApi} setTimeDates={setTimeDates} setPositions={setPositions} setSelectedTime={setSelectedTime}/>\n        <TimeList TimeDates={TimeDates} GetPositions={GetPositions} selectedTime={selectedTime} setSelectedTime={setSelectedTime}/>\n      </div>\n      <Map Positions={Positions} centerPositions={centerPositions}/>\n    </div>\n  );\n}\n\nexport default App;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}